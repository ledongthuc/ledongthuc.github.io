<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>Retry strategies and patterns</title><meta name=description content="A space where I put my notes, researches and stuffs."><link rel=stylesheet type=text/css href="http://fonts.googleapis.com/css?family=Ubuntu:regular,bold&subset=Latin"><link rel=stylesheet href=/css/style.css?1659988800><meta property="og:title" content="Thuc notes - Retry strategies and patterns"><meta property="og:description" content="Provide common retry strategies and patterns such as fibonacci, exponential, linear, polynomial"><meta property="og:image" content="https://thuc.space/images/retry_strategies/social.png"><meta property="og:image:type" content="image/png"><meta property="og:type" content="website"></head><body><div class=header>Thuc notes &copy; 2022<div class=menu>| <a href=/>home</a>
| <a href=/series/>series</a>
| <a href=/tags/>tags</a>
| <a href=/about-me/>about me</a></div></div><h1>Retry Strategies and Patterns</h1><div class=main><div class=article>Part of series <a class=series href=/series/software-development>software development</a> |
<time>2022-05-17</time><div class=content><h1 id=retry-strategies>Retry Strategies</h1><p>With the development of microservices, software as a service and cloud nowadays, network communication between components or services is the most important part of software development. But more network communications, we faced more network problems while developing the system.</p><p>Retry is one of the solutions to handle these problems. If the system got fails action, the system can do it again. There is the main idea of any retry strategy.</p><p>Let&rsquo;s take a look at common retry strategies and their benefits when applying them.</p><p><img src=https://thuc.space/images/retry_strategies/social.png alt="backoff strategies"></p><h2 id=no-backoff>No Backoff</h2><p>No backoff retry&rsquo;s a super bare way to do retry strategy. It does the retry action immediately after failed action and has no waiting duration between retry actions if they fail.</p><pre><code>duration(t) = 0
</code></pre><p><img src=https://thuc.space/images/retry_strategies/retry_strategies-no_backoff.png alt="No backoff"></p><p>No backoff retry strategy is also treated as bad practice because they make the system over-working by doing the retry actions extremely. It makes both caller and callee take resources when caller can&rsquo;t handle process during that time.</p><p>The no backoff retry should be used in special cases where you are aware of what you are doing. If you are not sure, let to use one of the next strategies, that save your system better.</p><h2 id=constant-backoff>Constant Backoff</h2><p>The most common way to implement the retry strategy. Constant backoff retry adds a fixed waiting duration after the first failure and between retry actions.</p><pre><code>duration(t) = &lt;constant value&gt;
</code></pre><p><img src=https://thuc.space/images/retry_strategies/retry_strategies-constant_backoff.png alt="Constant backoff"></p><p>The constant backoff retry gives callee time to breathe and recover if it failed. It provides more chances for the retry successful next time. The constant backoff works well in most situations when many concurrent retry action is small and the failed problem is fixed in a short time.</p><p>When the number of retry actions matters, especially network problems with many callers; or the system takes a long time to recover; the fixed waiting duration of constant backoff retry doesn&rsquo;t give the best result. The stress is accumulated and makes the system longer to recover.</p><p>A term is if the system can&rsquo;t recover after (x) duration, then it doesn&rsquo;t have any proof about the system is back after the same (x) duration. So it should increase the next waiting time when we have more chances for recovering the system.</p><p>To handle it, they suggest the next solution.</p><h2 id=linear-backoff>Linear Backoff</h2><p>The linear backoff retry strategy supports the waiting duration after the first failure and increases the waiting duration of the next retries. It increases constantly delta x from the previous waiting time with the formula:</p><pre><code>duration(t) = duration(t-1) + x
</code></pre><p><img src=https://thuc.space/images/retry_strategies/retry_strategies-linear_backoff.png alt="Linear backoff"></p><p>In the linear backoff retry strategy, we define constantly delta x and first waiting duration(0).</p><h2 id=fibonacci-backoff>Fibonacci Backoff</h2><p>The Fibonacci backoff retry strategy supports the waiting duration that calculates by using the Fibonacci sequence with the formula:</p><pre><code>duration(t) = duration(t-1) + duration(t-2)
</code></pre><p>In the Fibonacci backoff retry strategy, we define the first and second waiting duration(0) and duration(1).</p><p><img src=https://thuc.space/images/retry_strategies/retry_strategies-fibonacci_backoff.png alt="Fibonacci backoff"></p><h2 id=quadratic-backoff>Quadratic Backoff</h2><p>The quadratic backoff retry strategy supports the waiting duration that calculates by following the quadratic curve with the formula:</p><pre><code>duration(t) = attempt ^ 2 * base-time
</code></pre><p>In the quadratic backoff retry strategy, we define the base-time duration, such as 1s or 100ms. The attempt is time we do retry.</p><p><img src=https://thuc.space/images/retry_strategies/retry_strategies-quadratic_backoff.png alt="Quadratic backoff"></p><h2 id=exponential-backoff>Exponential Backoff</h2><p>The exponential backoff retry strategy supports the waiting duration that calculates by following the exponential curve with the formula:</p><pre><code>duration(t) = 2 ^ attempt * base-time
</code></pre><p>In the exponential backoff retry strategy, we define the base-time duration, such as 1s or 100ms. The attempt is time we do retry.</p><p><img src=https://thuc.space/images/retry_strategies/retry_strategies-exponential_backoff.png alt="Exponential backoff"></p><h2 id=polynomial-backoff>Polynomial Backoff</h2><p>The Polynomial backoff retry strategy supports the waiting duration that calculates by following the formula:</p><pre><code>duration(t) = attempt ^ degree * base-time
</code></pre><p><img src=https://thuc.space/images/retry_strategies/retry_strategies-polynomial_backoff.png alt="Polynomial backoff"></p><p>In the Polynomial backoff retry strategy, we define the degree and base-time duration, such as 1s or 100ms. With polynomial backoff, we can define degree number input, so quadratics is a special case of polynomial backoff with the fixed degree is 2. The attempt is time we do retry.</p><h2 id=jitter>Jitter</h2><p>Suppose we have multiple retry callers do an action or send requests that collide and fail. They all decide to retry with a backoff strategy. They will all retry at the same time, which leads to colliding again.</p><p>Jitter is a technique to solve that problem. It adds or removes different random waiting durations to back off time. So each next retry will happen at a different time and help to avoid several calls next time.</p><p><img src=https://thuc.space/images/retry_strategies/retry_strategies-jitter.png alt="Jitter backoff"></p><h1 id=external-references>External references:</h1><ul><li><a href=https://aws.amazon.com/blogs/architecture/exponential-backoff-and-jitter/>https://aws.amazon.com/blogs/architecture/exponential-backoff-and-jitter/</a></li><li><a href=https://www.researchgate.net/publication/3335069_Performance_analysis_of_exponential_backoff>https://www.researchgate.net/publication/3335069_Performance_analysis_of_exponential_backoff</a></li><li><a href=https://www.researchgate.net/publication/224440820_An_application_dependent_medium_access_protocol_for_active_RFID_using_dynamic_tuning_of_the_back-off_algorithm>https://www.researchgate.net/publication/224440820_An_application_dependent_medium_access_protocol_for_active_RFID_using_dynamic_tuning_of_the_back-off_algorithm</a></li></ul></div><div class=tags>Tags: <a class=tag href=/tags/retry>retry</a> | <a class=tag href=/tags/backoff>backoff</a> | <a class=tag href=/tags/transient-fault>transient fault</a> |</div></div></div></body></html>